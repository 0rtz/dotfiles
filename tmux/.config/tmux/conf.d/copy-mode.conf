# Activate copy mode with <Ctrl-a>d
bind d copy-mode
bind C-d copy-mode

# Search in copy mode
bind / copy-mode \; send /
bind ? copy-mode \; send ?

# Vim key bindings in copy mode
set -g mode-keys vi
bind -T copy-mode-vi L send -X end-of-line
bind -T copy-mode-vi H send -X start-of-line
bind -T copy-mode-vi v send -X begin-selection
bind -T copy-mode-vi / command-prompt -p "(search up)" "send -X search-backward \"%%%\""
bind -T copy-mode-vi ? command-prompt -p "(search down)" "send -X search-forward \"%%%\""
# Copy without exiting copy mode
bind -T copy-mode-vi y send -X copy-selection

# Enable system clipboard integration
set -s set-clipboard on

# Detect clipboard availability and set tmux variable
run-shell " \
  if command -v wl-copy >/dev/null 2>&1; then \
    tmux set -g @tmux_copy_command 'wl-copy'; \
  elif command -v xclip >/dev/null 2>&1; then \
    tmux set -g @tmux_copy_command 'xclip -in -selection clipboard'; \
  elif command -v xsel >/dev/null 2>&1; then \
    tmux set -g @tmux_copy_command 'xsel --clipboard --input'; \
  else \
    tmux set -g @tmux_copy_command 'cat >/dev/null'; \
  fi"